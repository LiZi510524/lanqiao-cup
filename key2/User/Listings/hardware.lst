C51 COMPILER V9.54   HARDWARE                                                              12/13/2023 16:51:47 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE HARDWARE
OBJECT MODULE PLACED IN .\Objects\hardware.obj
COMPILER INVOKED BY: E:\APP\Keil 5\C51\BIN\C51.EXE hardware.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listin
                    -gs\hardware.lst) TABS(2) OBJECT(.\Objects\hardware.obj)

line level    source

   1          #include "hardware.h"
   2          
   3          unsigned char com[9]={0,0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};//数码管位
   4          
   5          /*************  本地常量声明    **************/
   6          unsigned char code seg[]={                       //标准字库
   7          //   0    1    2    3    4    5    6    7    8    9    A    B    C    D    E    F
   8              0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x07,0x7F,0x6F,0x77,0x7C,0x39,0x5E,0x79,0x71,
   9          //black  -     H    J    K    L    N    o   P    U     t    G    Q    r   M    y
  10              0x00,0x40,0x76,0x1E,0x70,0x38,0x37,0x5C,0x73,0x3E,0x78,0x3d,0x67,0x50,0x37,0x6e,
  11              0xBF,0x86,0xDB,0xCF,0xE6,0xED,0xFD,0x87,0xFF,0xEF,0x46};    //0. 1. 2. 3. 4. 5. 6. 7. 8. 9. -1
  12          
  13              
  14          void Timer1Init()   //1毫秒@12.000MHz
  15          {
  16   1        AUXR |= 0x40;     //定时器时钟1T模式
  17   1        TMOD &= 0x0F;     //设置定时器模式
  18   1        TL1 = 0x20;       //设置定时初始值
  19   1        TH1 = 0xD1;       //设置定时初始值
  20   1        TF1 = 0;        //清除TF1标志
  21   1        TR1 = 1;        //定时器1开始计时
  22   1        ET1 = 1;
  23   1        EA = 1;
  24   1      }   
  25          
  26          void Close()
  27          {
  28   1        P2=0x00;
  29   1        
  30   1        P0=0xff;
  31   1        P2|=0x80;  //关闭Led
  32   1        P2&=0x1f;
  33   1        
  34   1        P0=0x00;
  35   1        P2|=0XC0; //关闭继电器、蜂鸣器
  36   1        P2&=0x1f;
  37   1      }
  38          
  39          void seg_dis(unsigned char m,unsigned char n)
  40          {
  41   1        Close();
  42   1        
  43   1        P0=~seg[m];
  44   1        P2|=0xe0;
  45   1        P2&=0x1f;
  46   1        
  47   1        P0=com[n];
  48   1        P2|=0XC0;
  49   1        P2&=0X1f;
  50   1      }
  51          
  52          
  53          
  54          unsigned char key_values[4][4]=
C51 COMPILER V9.54   HARDWARE                                                              12/13/2023 16:51:47 PAGE 2   

  55          {
  56            4,5,6,7,
  57            8,9,10,11,
  58            12,13,14,15,
  59            16,17,18,19
  60          };
  61          unsigned char key_value;
  62          unsigned int key_state=0;
  63          unsigned char timer10ms=0;
  64          void get_key()
  65          {
  66   1        unsigned char X,Y;
  67   1        P3=0x0F;
  68   1        P4=0x00;
  69   1        if(~P3&0x0f)
  70   1        {
  71   2         if(key_state<255)
  72   2           key_state++;
  73   2         
  74   2         if(P33==0)
  75   2         {
  76   3           Y=0;
  77   3         }
  78   2         if(P32==0)
  79   2         {
  80   3           Y=1;
  81   3         }
  82   2         if(P31==0)
  83   2         {
  84   3           Y=2;
  85   3         }
  86   2         if(P30==0)
  87   2         {
  88   3           Y=3;
  89   3         }
  90   2         
  91   2         P3=0xF0;
  92   2         P4=0xFF;
  93   2         if(P44==0)
  94   2         {
  95   3           X=0;
  96   3         }
  97   2         if(P43==0)
  98   2         {
  99   3           X=1;
 100   3         }
 101   2         if(P35==0)
 102   2         {
 103   3           X=2;
 104   3         }
 105   2         if(P34==0)
 106   2         {
 107   3           X=3;
 108   3         }
 109   2         key_value=key_values[X][Y];
 110   2        }
 111   1        else
 112   1        {
 113   2          key_value=0;
 114   2          key_state=0;
 115   2        }
 116   1      }
C51 COMPILER V9.54   HARDWARE                                                              12/13/2023 16:51:47 PAGE 3   

 117          
 118          void timer1_isr() interrupt 3
 119          {
 120   1        timer10ms++;
 121   1      }
 122          
 123          
 124          
 125          
 126          
 127          
 128          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    175    ----
   CONSTANT SIZE    =     43    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     29    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
